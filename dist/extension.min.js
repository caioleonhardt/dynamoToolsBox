!function(e){var t=function(){"use strict";var e={appName:"Dynamo Tool Box",copyright:"Created by Matheus Barbieri - Contributions by Caio Leonhardt - version 0.2.1"},t={_data:{},setItem:function(e,t){return this._data[e]=String(t)},getItem:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0},removeItem:function(e){return delete this._data[e]},clear:function(){return this._data={}}};return localStorage&&(t=localStorage),{config:e,storage:t}}();Object.defineProperty(e,"CONSTANTS",{value:function(){var e={};return Object.defineProperty(e,"appName",{value:t.config.appName,writable:!1}),Object.defineProperty(e,"welcomeMessage",{value:"-- Initialized Dynamo Tool Box --",writable:!1}),e}(),writable:!1}),e.DynamoToolBox=t}(window),function(window,unsafeWindow,DynamoToolBox){"use strict";var render=function(){function renderHtmlTags(html){for(var regex=/\{\{([a-zA-Z\.]*)\}\}/g,str=html,replacedString=str,match;null!==(match=regex.exec(str));)if(match.index===regex.lastIndex&&regex.lastIndex++,match[0]){var replaceText=match[0];try{var replaceValue=eval(match[1]);replacedString=replacedString.replace(replaceText,replaceValue)}catch(e){replacedString=replacedString.replace(replaceText,"")}}return replacedString}return{renderHtmlTags:renderHtmlTags}}();DynamoToolBox.render=render}(window,unsafeWindow,DynamoToolBox),function(e,t,n){"use strict";var o=function(){return{invoke:function(e,t,n){var o=new XMLHttpRequest,e=e;if(t){for(var a="?",i=Object.keys(t),r=0;r<i.length;r++){r>0&&(a+="&");var l=i[r];a+=l+"="+t[l]}e+=a}o.open("POST",e,!0),o.setRequestHeader("Content-type","application/json; charset=utf-8"),o.setRequestHeader("Connection","close"),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&n&&n(o)},o.send()}}}();n.request=o}(window,unsafeWindow,DynamoToolBox),function(e,t,n){"use strict";var o=function(){return{remove:function(){var e=document.getElementById("dynamoTools");e&&document.body.removeChild(e)},toggleView:function(){var e=document.getElementById("contentToolsBox"),t=event.target;if(e&&t){if(e.classList.contains("hide"))return n.storage.setItem("minimizedToolBox",!1),e.classList.remove("hide"),void(t.innerText="-");n.storage.setItem("minimizedToolBox",!0),t.innerText="+",e.classList.add("hide")}},isJDBCPage:function(){return/jdbcbrowser\/executeQuery.jhtml/.test(location.pathname)},isNucleusPage:function(){return/\/nucleus\//.test(location.pathname)},isRepositoryPage:function(){return/\/nucleus\/.*Repository|.*Catalog/.test(location.pathname)},validateHide:function(){"true"==n.storage.getItem("minimizedToolBox")&&document.getElementById("contentToolsBox").classList.add("hide")},addComponentBox:function(){var e=n.render.renderHtmlTags('<div id="dynamoTools" class="dynamoToolsBox"><h3>{{DynamoToolBox.config.appName}}<span class="navigation remove" id="removeToolBox">X</span><span class="navigation toogle" id="toogleToolBox">-</span></h3><div><ul id="contentToolsBox"></ul></div></div>');document.body.innerHTML+=e}}}();n.global=o}(window,unsafeWindow,DynamoToolBox),function(e,t,n){"use strict";var o=function(){function t(){var t=document.createElement("style");t.type="text/css";var n="1";e.innerWidth<2e3&&(n="0.8"),e.innerWidth<=1440&&(n="0.7");var o=".dynamoToolsBox{position:fixed;top:0;right:-1px;width:500px;background-color:#545454;border:3px solid #545454;overflow:hidden;zoom:"+n+"}.dynamoToolsBox h3{color:#fff;text-align:center;margin:10px}.dynamoToolsBox .navigation{position:absolute;top:0;background-color:#696969;cursor:pointer;width:41px;height:41px;text-align:center;vertical-align:middle;line-height:41px}.dynamoToolsBox .remove{right:0}.dynamoToolsBox .toogle{right:42px}.dynamoToolsBox ul{list-style:none;margin:0;padding:0}.dynamoToolsBox li{border-bottom:2px solid #dcdcdc;background-color:#fdfdfd;display:inline-block;width:100%;padding:10px}.dynamoToolsBox .hide{display:none}.dynamoToolsBox .info label{float:left;font-weight:700}.dynamoToolsBox .info div{float:left}.dynamoToolsBox .green{background-color:#abffa5}.dynamoToolsBox .red{background-color:red}.dynamoToolsBox .info h3{color:#2d2d2d;font-size:20px;margin:0}.dynamoToolsBox .execute label{float:left;font-weight:700}.dynamoToolsBox .execute div{float:left}pre.prettyprint{padding:0!important;border:0!important}.dynamoToolsBox .copyright p{padding:0;font-size:11px;margin:0;text-align:right;padding-right:20px}.atv{cursor:pointer}.dynamoToolsBox .autocomplete{background-color:#eaeaea;width:95%;border:1px solid #c1c1c1;border-top:0;overflow:hidden;display:none}.dynamoToolsBox .autocomplete.visible{display:block}.dynamoToolsBox .autocomplete span{width:100%;display:inline-block;padding:3px}.dynamoToolsBox .autocomplete span.active{background-color:#fff;color:#009}.itemDescActions{display:none;position:absolute;background:#fff;border:1px solid #898989;width:106px;left:79px;text-transform:capitalize;cursor:pointer}.itemDescActions div{padding:3px;color:#000}.itemDescActions div:hover{background-color:#f3f3f3}.itenDescAutoComplete:hover .itemDescActions{display:block}.dynamoToolsBox .favorites{background-color:#ececec;padding-top:0}.dynamoToolsBox .favorites a{width:100%;display:inline-block;padding:5px 0}";t.styleSheet?t.styleSheet.cssText=o:t.appendChild(document.createTextNode(o)),document.getElementsByTagName("head")[0].appendChild(t)}return t(),{injectPretify:function(){var e=document.createElement("script");e.src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js",e.defer=!0,document.getElementsByTagName("head")[0].appendChild(e)}}}();n.inject=o}(window,unsafeWindow,DynamoToolBox),function(e,t,n){"use strict";function o(){var n=!1;h("whereAmI","info green","");var o=0,a=setInterval(function(){if(o++,t.mappedHosts&&t.mappedHosts.size>0){var i=e.location.host;t.mappedHosts&&t.mappedHosts.get(e.location.host)&&(i=t.mappedHosts.get(e.location.host).name,n=t.mappedHosts.get(e.location.host).production),document.getElementById("whereAmI")&&(document.getElementById("whereAmI").innerHTML="<h3>"+i+"</h3>",n&&(document.getElementById("whereAmI").classList.remove("green"),document.getElementById("whereAmI").classList.add("red"))),clearInterval(a)}o>10&&clearInterval(a)},300)}function a(){x("copyright","info copyright",n.config.copyright)}function i(){var e=document.getElementsByTagName("textarea")[0];e&&T("descTable","Desc table","Table Name",function(){var t=event.target.parentNode.getElementsByTagName("input")[0];if(t&&t.value){var n="SELECT table_name, column_name, data_type FROM ALL_TAB_COLUMNS WHERE TABLE_NAME like '"+t.value.toUpperCase()+"'";e.value=n,e.focus()}},!1)}function r(){var e=document.getElementsByTagName("textarea")[0];e&&E("printItem","Print Item","Item Descriptor","Value",function(){var t=event.target.parentNode.getElementsByTagName("input");if(t[0]&&t[0].value&&t[1]&&t[1].value){var n=e.value;n+="\n",n+='<print-item item-descriptor="'+t[0].value+'" id="'+t[1].value+'"/>',e.value=n,e.focus()}},!0)}function l(){var e=document.getElementsByTagName("textarea")[0];e&&T("queryItem","Query Item","Item Descriptor",function(){var t=event.target.parentNode.getElementsByTagName("input")[0];if(t&&t.value){var n=e.value;n+="\n",n+='<query-items item-descriptor="'+t.value+'"> = ""</query-items>',e.value=n}setTimeout(function(){y(e,n.lastIndexOf("> =")+1)},10)},!0)}function c(){T("setPropertyDescriptor","See property description","Item Descriptor",function(){var t=event.target.parentNode.getElementsByTagName("input")[0];if(t&&t.value){var n=z()+"?action=seetmpl&itemdesc="+t.value+"#showProperties";e.location=n}},!0)}function d(){document.getElementsByTagName("textarea")[0]&&E("seeItem","See Item","Item Descriptor","Value",function(){var t=event.target.parentNode.getElementsByTagName("input");if(t[0]&&t[0].value){var n=z()+"?action=seeitems&itemdesc="+t[0].value;t[1]&&t[1].value&&(n+="&itemid="+t[1].value),n+="#seeItems",e.location=n}},!0,!0)}function s(){B("invokeMethod","Invoke Method",u(),function(e){var t=e.target;t&&t.value&&(location=t.value)})}function u(){var e=document.getElementsByTagName("h1"),t=[];if(e)for(var n=0;n<e.length;n++)if("Methods"==e[n].innerText){var o=e[n].nextElementSibling;if(o){var a=o.getElementsByTagName("tr");if(a)for(var i=0;i<a.length;i++){var r=a[i].getElementsByTagName("td")[0];if(r&&r.getElementsByTagName("a")){var l=r.getElementsByTagName("a")[0],c={value:l.getAttribute("href"),text:l.innerText};t.push(c)}}}}return t}function m(){b("viewServiceConfiguration","View Service Configuration",z()+"?propertyName=serviceConfiguration")}function v(){b("viewDefinitionFiles","View Definition Configuration",z()+"?propertyName=definitionFiles")}function g(){b("viewComponent","View Component",z())}function p(){b("executeQuery","Execute Query","/dyn/admin/atg/dynamo/admin/en/jdbcbrowser/executeQuery.jhtml")}function f(){T("searchMethod","Search Component","Query",function(){var t=event.target.parentNode.getElementsByTagName("input")[0];if(t&&t.value){var n="/dyn/admin/atg/dynamo/admin/en/cmpn-search.jhtml?query="+t.value;e.location=n}},!1)}function y(e,t){null!==e&&(e.selectionStart?(e.focus(),e.setSelectionRange(t,t)):e.focus())}function h(e,t,n){I("LI",e,t,"<h3>"+n+"</h3>","contentToolsBox")}function x(e,t,n){I("LI",e,t,"<p>"+n+"</p>","contentToolsBox")}function T(e,t,n,o,a){I("LI",null,"execute","<div><label>"+t+':&nbsp;</label><input type="text" placeholder="'+n+'" autocomplete="'+a+'" id="'+("input"+e+(new Date).getTime())+'"></input><button id="'+e+'">OK</button></div>',"contentToolsBox"),document.getElementById(e).addEventListener("click",o);var i=document.getElementById(e).parentNode.getElementsByTagName("input")[0];i&&i.addEventListener("keydown",function(t){13==t.keyCode&&setTimeout(function(){document.getElementById(e).click()},300)})}function b(e,t,n){I("LI",null,"execute","<div><label>"+t+':&nbsp;</label><a id="'+e+'" href="'+n+'">GOTO</button></div>',"contentToolsBox")}function B(e,t,n,o){if(!(n.length<1)){var a="<div><label>"+t+':&nbsp;</label><select id="'+e+'"><option value="">Selecione</option>';if(n)for(var i=0;i<n.length;i++)a+='<option value="'+n[i].value+'">'+n[i].text+"</option>";I("LI",null,"execute",a+="</select></div>","contentToolsBox"),document.getElementById(e).addEventListener("change",o)}}function E(e,t,n,o,a,i,r){I("LI",null,"execute","<div><label>"+t+':&nbsp;</label><input type="text" placeholder="'+n+'" autocomplete="'+i+'" data-gotosecond="true" id="'+("input1"+e+(new Date).getTime())+'"></input><input type="text" placeholder="'+o+'" id="'+("input2"+e+(new Date).getTime())+'"></input><button id="'+e+'">OK</button></div>',"contentToolsBox"),document.getElementById(e).addEventListener("click",a);var l=document.getElementById(e).parentNode.getElementsByTagName("input");if(l)for(var c=0;c<l.length;c++)r||l[c].addEventListener("keydown",function(t){13==t.keyCode&&setTimeout(function(){document.getElementById(e).click()},100)})}function I(e,t,n,o,a){var i=document.body;a&&(i=document.getElementById(a));var r=document.createElement(e);t&&r.setAttribute("id",t),r.setAttribute("class",n),r.innerHTML=o,i.appendChild(r)}function w(){var e=document.getElementById("removeToolBox");e&&e.addEventListener("click",n.global.remove);var t=document.getElementById("toogleToolBox");t&&t.addEventListener("click",n.global.toggleView),document.body.addEventListener("keypress",function(e){N(e)})}function N(e){if(e&&e.ctrlKey){if(e.shiftKey&&6==e.keyCode){var t=document.getElementById("searchMethod");if(t){var o=t.parentElement;if(o){var a=o.getElementsByTagName("input")[0].focus();a&&a.focus()}}}if(10==e.keyCode&&!n.global.isJDBCPage()){var i=document.getElementsByTagName("textarea")[0];if(i){var r=i.parentElement.parentElement;"FORM"==r.nodeName&&r.submit()}}}}function L(){var e=!1,t=document.getElementsByTagName("pre");if(t){for(var n=0;n<t.length;n++)t[n].classList.add("prettyprint");e=!0}var o=document.getElementsByTagName("code");if(o)for(var a=0;a<o.length;a++)o[a].classList.add("language-xml");return e&&"undefined"!=typeof PR&&PR.prettyPrint(),e}function S(){var e=setInterval(function(){L()&&(M(),setTimeout(function(){P()},500),clearInterval(e))},300)}function C(){A(),D();var e=document.getElementById("dynamoTools").getElementsByTagName("input");if(document.body.addEventListener("click",j),e)for(var t=0;t<e.length;t++){var n=e[t];"true"==n.getAttribute("autocomplete")&&(n.addEventListener("keyup",k),n.addEventListener("focus",k))}}function A(){var e=document.getElementsByName("listItemDescriptors")[0];if(e){var t=e.nextElementSibling.getElementsByTagName("th");if(t)for(var n=0;n<t.length;n++)n>3&&G.push(t[n].innerHTML)}}function k(){var e=event.target,t=e.value;if(0!=t.length){var n=e.parentNode,o=e.getAttribute("id"),a="auto"+o,i=!0,r=document.getElementById(a);r||(i=!1,r=document.createElement("DIV"),a&&r.setAttribute("id",a),r.setAttribute("targetId",o),r.setAttribute("class","autocomplete js-autocomplete visible"));var l="";for(var c in G)G[c].startsWith(t)&&(l+="<span>"+G[c]+"</span>");r.innerHTML=l,U=!0,i?r.classList.add("visible"):n.appendChild(r)}}function D(){document.body.addEventListener("keyup",function(e){U&&H(e)})}function H(e){var t=!1,n=!1;if("38"==e.keyCode&&(X>0&&X--,t=!0),"40"==e.keyCode&&(X<Z-1&&X++,t=!0),"13"==e.keyCode&&(n=!0),"9"==e.keyCode&&(Y=!0,j()),t||n){var o=document.getElementsByClassName("js-autocomplete");if(o)for(var a=0;a<o.length;a++){var i=o[a];if(i.classList.contains("visible")){var r=i.getElementsByTagName("span");if(Z=r.length,r){if(n){var l=i.getAttribute("targetId"),c=document.getElementById(l);if(c){var d=r[X];d&&(c.value=d.innerText,Y=!0,j())}return}for(var s=0;s<r.length;s++){var u=r[s];u.classList.remove("active"),s==X&&u.classList.add("active")}}}}}}function j(){var e=document.getElementsByClassName("js-autocomplete");if(e)for(var t=0;t<e.length;t++){var n=e[t];if(n){var o=event.target;if(!Y&&o&&o.getAttribute("id")==n.getAttribute("targetId"))break;Y=!1,n.classList.remove("visible"),U=!1,X=0,Z=0}}}function P(){var e=document.getElementsByClassName("atv");if(e&&!/.*definitionFiles.*/.test(location.search))for(var t=0;t<e.length;t++){var n=e[t],o=n.previousElementSibling.previousElementSibling.innerHTML;"id"!=o&&"item-descriptor"!=o&&n.addEventListener("click",V)}}function M(){var e=setInterval(function(){var t=document.getElementsByClassName("atn");if(t[0]){clearInterval(e);for(var n=0;n<t.length;n++){var o=t[n];if("item-descriptor"==o.innerText){var a=o.nextElementSibling.nextElementSibling.innerHTML.replace(/\"/g,""),i=o.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling;if("id"==i.innerText){var r=i.nextElementSibling.nextElementSibling.innerText.replace(/\"/g,"");o.classList.add("itenDescAutoComplete");var l='<div class="itemDescActions" data-id="'+r+'" data-itemdesc="'+a+'">';l+='<div id="remove_'+r+'">remove</div>',l+='<div id="update_'+r+'">update</div>',l+='<div id="print_'+r+'">print</div>',l+="</div>",o.innerHTML+=l,document.getElementById("remove_"+r).addEventListener("click",_),document.getElementById("update_"+r).addEventListener("click",O),document.getElementById("print_"+r).addEventListener("click",R)}}}}},300)}function _(){var e=event.target.parentElement,t=e.getAttribute("data-id"),n='<remove-item item-descriptor="'+e.getAttribute("data-itemdesc")+'" id="'+t+'"/>',o=document.getElementsByTagName("textarea")[0];if(o){var a="\n";a+=n,o.value+=a,o.focus()}}function O(){var e=event.target.parentElement,t=e.getAttribute("data-id"),n='<update-item item-descriptor="'+e.getAttribute("data-itemdesc")+'" id="'+t+'">';n+='\n\t<set-property name=""><![CDATA[]]></set-property>',n+="\n</update-item>";var o=document.getElementsByTagName("textarea")[0];if(o){var a="\n";a+=n,o.value+=a,o.focus()}}function R(){var e=event.target.parentElement,t=e.getAttribute("data-id"),n='<print-item item-descriptor="'+e.getAttribute("data-itemdesc")+'" id="'+t+'"/>',o=document.getElementsByTagName("textarea")[0];if(o){var a="\n";a+=n,o.value+=a,o.focus()}}function V(){var e=event.target,t=e.nextElementSibling.nextElementSibling;if(t){var n=document.getElementsByTagName("textarea")[0];if(n){var o=n.value;o+="\n";var a=W(t.innerText);if(a.indexOf(",")>0)for(var i=a.split(","),r=0;r<i.length;r++)o+="<print-item item-descriptor="+e.innerText+' id="'+i[r]+'"/>',o+="\n";else o+="<print-item item-descriptor="+e.innerText+' id="'+a+'"/>';n.value=o,n.focus()}}}function W(e){return e.replace("<![CDATA[","").replace("]]>","")}function z(){return location.pathname.endsWith("/")?location.pathname:location.pathname+"/"}function q(){if(/cmpn-search.jhtml/.test(location.pathname)){var e=document.getElementsByTagName("a");if(e)for(var t=0;t<e.length;t++){var n=e[t];/\/\//.test(n.getAttribute("href"))&&n.setAttribute("href",n.getAttribute("href").replace("//","/"))}}}function Q(){var e="favoriteLinks";I("LI",e,"favorites","","contentToolsBox");var n=0,o=setInterval(function(){if(n++,t.favorites){clearInterval(o);for(var a="",i=0;i<t.favorites.length;i++){var r=t.favorites[i];a+='<a href="/dyn/admin/nucleus'+r+'">'+r+"</a>"}document.getElementById(e).innerHTML=a}n>10&&clearInterval(o)},300)}function F(){var e=[{value:"/atg/dynamo/service/jdbc/JTDataSource",text:"CORE"},{value:"/atg/dynamo/service/jdbc/SwitchingDataSource",text:"SWITCH"},{value:"/atg/dynamo/service/jdbc/SwitchingDataSourceA",text:"CATALOG_A"},{value:"/atg/dynamo/service/jdbc/SwitchingDataSourceB",text:"CATALOG_B"}],o=0,a=setInterval(function(){if(o++,t.datasources&&(clearInterval(a),t.datasources&&t.datasources.length>0))for(var e=0;e<t.datasources.length;e++){var n=t.datasources[e],i='<option value="'+n.value+'">'+n.text+"</option>";document.getElementById("switchDataSource").innerHTML+=i}o>10&&clearInterval(a)},300);B("switchDataSource","Switch Data Source",e,function(e){var t=e.target;if(t&&t.value){var o={propertyName:"connectionPool",newValue:t.value,change:"Change Value"};n.request.invoke("/dyn/admin/nucleus/atg/dynamo/admin/jdbcbrowser/ConnectionPoolPointer/",o,null)}})}function J(){n.global.isJDBCPage()&&(n.inject.injectPretify(),i(),F())}function K(){n.global.isNucleusPage()&&(g(),m(),s()),n.global.isRepositoryPage()&&(n.inject.injectPretify(),v(),r(),l(),d(),c(),S(),C())}e.console&&console.info&&console.info(CONSTANTS.welcomeMessage);var G=[],U=!1,X=0,Z=0,Y=!1;n.global.remove(),n.global.addComponentBox(),n.global.validateHide(),o(),f(),p(),J(),K(),w(),Q(),a(),q()}(window,unsafeWindow,DynamoToolBox);